<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI" />
    <meta name="google-site-verification" content="NSuSSEIi39jKPcsGcrgrsE3Ytz6UuDJMYbOIIOqqRLw" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Across the Great Wall, we can reach every corner in the world">
    <meta name="keywords"  content="ZW, Zekun Blog, 王泽坤的博客, zekunwang, 王泽坤, data science, DS, machine learning">
    <meta name="theme-color" content="#000000">
    
    <title>Cashbox Magazine Song Chart Analysis - Zekun Wang's Blog | Data Science</title>

    <!-- Web App Manifest -->
    <link rel="manifest" href="/pwa/manifest.json">

    <!-- Favicon -->
    <link rel="shortcut icon" href="/img/favicon.ico">

    <!-- Safari Webpage Icon    by-BY -->
    <link rel="apple-touch-icon" href="/img/apple-touch-icon.png">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="http://localhost:4000/2020/02/15/song-analysis/">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/hux-blog.min.css">

    <!-- Pygments Github CSS -->
    <link rel="stylesheet" href="/css/syntax.css">

    <!-- Custom Fonts -->
    <!-- <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"> -->
    <!-- Hux change font-awesome CDN to qiniu -->
    <link href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css">


    <!-- Hux Delete, sad but pending in China
    <link href='http://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/
    css'>
    -->


    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- ga & ba script hoook -->
    <script></script>
</head>


<!-- hack iOS CSS :active style -->
<body ontouchstart="">

    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Zekun Blog</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div id="huxblog_navbar">
            <div class="navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="/">Home</a>
                    </li>
                    
                    <li>
                        <a href="/about/">About</a>
                    </li>
                    
                    <li>
                        <a href="/tags/">Tags</a>
                    </li>
                    
                </ul>
            </div>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>
<script>
    // Drop Bootstarp low-performance Navbar
    // Use customize navbar with high-quality material design animation
    // in high-perf jank-free CSS3 implementation
    var $body   = document.body;
    var $toggle = document.querySelector('.navbar-toggle');
    var $navbar = document.querySelector('#huxblog_navbar');
    var $collapse = document.querySelector('.navbar-collapse');

    var __HuxNav__ = {
        close: function(){
            $navbar.className = " ";
            // wait until animation end.
            setTimeout(function(){
                // prevent frequently toggle
                if($navbar.className.indexOf('in') < 0) {
                    $collapse.style.height = "0px"
                }
            },400)
        },
        open: function(){
            $collapse.style.height = "auto"
            $navbar.className += " in";
        }
    }

    // Bind Event
    $toggle.addEventListener('click', function(e){
        if ($navbar.className.indexOf('in') > 0) {
            __HuxNav__.close()
        }else{
            __HuxNav__.open()
        }
    })

    /**
     * Since Fastclick is used to delegate 'touchstart' globally
     * to hack 300ms delay in iOS by performing a fake 'click',
     * Using 'e.stopPropagation' to stop 'touchstart' event from 
     * $toggle/$collapse will break global delegation.
     * 
     * Instead, we use a 'e.target' filter to prevent handler
     * added to document close HuxNav.  
     *
     * Also, we use 'click' instead of 'touchstart' as compromise
     */
    document.addEventListener('click', function(e){
        if(e.target == $toggle) return;
        if(e.target.className == 'icon-bar') return;
        __HuxNav__.close();
    })
</script>


    <!-- Image to hack wechat -->
<!-- <img src="/img/icon_wechat.png" width="0" height="0"> -->
<!-- <img src="/img/post-song-analysis.jpeg" width="0" height="0"> -->

<!-- Post Header -->
<style type="text/css">
    header.intro-header{
        position: relative;
        background-image: url('/img/post-song-analysis.jpeg')
    }

    
</style>
<header class="intro-header" >
    <div class="header-mask"></div>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <div class="tags">
                        
                        <a class="tag" href="/tags/#EDA" title="EDA">EDA</a>
                        
                        <a class="tag" href="/tags/#Project" title="Project">Project</a>
                        
                        <a class="tag" href="/tags/#R" title="R">R</a>
                        
                        <a class="tag" href="/tags/#Text Analysis" title="Text Analysis">Text Analysis</a>
                        
                    </div>
                    <h1>Cashbox Magazine Song Chart Analysis</h1>
                    
                    
                    <h2 class="subheading">A simple example of a data analysis pipeline</h2>
                    
                    <span class="meta">Posted by Zekun on February 15, 2020</span>
                </div>
            </div>
        </div>
    </div>
</header>

<script type="text/javascript" async
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
</script>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

    <!-- Post Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                post-container">

				<iframe src="https://docs.google.com/presentation/d/e/2PACX-1vT8PsgoYD97P7ZvBxpVM3aCGnxX7A5_3o_ep7CqbsbGbuq7-MWdeCIRbNUvqfyJYuRliseB9j0DuqeE/embed?start=false&amp;loop=true&amp;delayms=3000" frameborder="0" width="700" height="423" allowfullscreen="true" mozallowfullscreen="true" webkitallowfullscreen="true"></iframe>

<p>This article mainly introduces the full picture of a data analysis pipeline by showing the simple data import, feature engineering, and exploratory data analysis processes. The data used this time is relatively clean, so basically no data cleaning has been performed except for the analysis part of this article.</p>

<p>The entire working process is divided into three parts: 10-read-in, 20-feature-engineering, 30-exploratory-data-analysis.</p>

<h2 id="10-read-in">10-read-in</h2>

<h4 id="import-libraries">Import libraries.</h4>

<pre><code class="language-{r}">library(readxl)
library(tidyverse)
library(janitor)
library(ggplot2)
library(tidytext)
library(wordcloud2)
library(RColorBrewer)
</code></pre>

<p>Library introduction (The parts used in this pipeline):</p>

<ul>
  <li><strong>readxl</strong>: read in data in Excel file.</li>
  <li><strong>tidyverse</strong>: help manage the data frame in tidy sentences.</li>
  <li><strong>janitor</strong>: clean the column names.</li>
  <li><strong>ggplot2</strong>: create plots.</li>
  <li><strong>tidytext</strong>: import stop words data for text analysis and get word
sentiment dictionary.</li>
  <li><strong>wordcloud2</strong>: create word cloud graph.</li>
  <li><strong>RColorBrewer</strong>: set color palette for graphes.</li>
</ul>

<h4 id="read-in-raw-data-and-make-the-column-names">Read in raw data and make the column names.</h4>

<pre><code class="language-{r}">for(i in seq(2000,2009,1)){
  df &lt;- read_excel("Analysis Exercise.xls", sheet = as.character(i))
  names(df) &lt;- df[1,]
  df &lt;- df[-1,] %&gt;%
    clean_names() %&gt;%
    mutate(year = i)
  assign(paste0("df_", i), df)
}
</code></pre>

<p>In this Excel file, the data of different years was divided into sub-tables, therefore, I need to read in them one by one.</p>

<p>And the column names in each table were not in the first row but in the second row. So I removed the first row and transferred the second row to be the column names. Then, I used the <code class="highlighter-rouge">clean_names()</code> function to make the names lowercase without blank space.</p>

<p>The function <code class="highlighter-rouge">assign</code> can help me use different names to reserve the data.</p>

<p>After that, I merged all of the data.</p>

<pre><code class="language-{r}">df &lt;-
  bind_rows(df_2000, df_2001, df_2002, df_2003, df_2004, df_2005, df_2006, df_2007, df_2008, df_2009)
</code></pre>

<p>Import the stop words for text analysis in the EDA part.</p>

<pre><code class="language-{r}">data("stop_words")
</code></pre>

<h2 id="20-feature-engineering">20-feature-engineering</h2>

<p>This data set is clean enough and I don’t need to clean the data as normal.</p>

<p>Basic feature engineering on raw merged data:</p>

<pre><code class="language-{r}">df &lt;- df %&gt;%
  mutate(weeks_at_number_1 = as.integer(weeks_at_number_1),
         weeks_top_10 = as.integer(weeks_top_10),
         weeks_top_25 = as.integer(weeks_top_25),
         weeks_top_50 = as.integer(weeks_top_50),
         peak_position = as.integer(peak_position),
         bonus_weeks = as.integer(bonus_weeks),
         sub_points = as.integer(sub_points),
         peak_points = as.integer(peak_points),
         total_points = as.integer(total_points),
         peak_year = as.integer(peak_year),
         debut_date = as.integer(debut_date),
         debut_date = as.Date(debut_date, origin="1899-12-30"),
         peak_date = as.integer(peak_date),
         peak_date = as.Date(peak_date, origin="1899-12-30"),
         weeks_to_reach_peak = as.integer(weeks_to_reach_peak),
         year=as.factor(year)
         )
</code></pre>

<p>In this chunk, I only need to make all of the columns have the right data
type.</p>

<p><strong>Hint:</strong> In the date part, because Excel save the date by count the
distance between the date and 1900-01-01, the date columns in the raw
data are the days. I need to transfer them to be the real date. The
<code class="highlighter-rouge">origin</code> attribute should be 1900-01-01, but due to 1900-leap-year-bug
of Excel, use 1899-12-30 can get the right answer.</p>

<h2 id="30-exploratory-data-analysis">30-exploratory-data-analysis</h2>

<p>In this part, I will answer the following questions to finish the
exploratory data analysis(EDA) part.</p>

<h4 id="what-percent-of-songs-that-chart-never-make-the-top-10">What percent of songs that chart never make the Top 10?</h4>

<p>For all years:</p>

<pre><code class="language-{r}">never_top10 &lt;- df %&gt;%
  filter(weeks_top_10 == 0)
nrow(never_top10)/nrow(df)
</code></pre>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] 0.6802455
</code></pre></div></div>

<p>Time series:</p>

<pre><code class="language-{r}">never_top10_year &lt;- df %&gt;%
  filter(weeks_top_10 == 0) %&gt;%
  group_by(year) %&gt;%
  summarise(never_top10_number = n())

all_year &lt;- df %&gt;%
  group_by(year) %&gt;%
  summarise(whole_number = n())

never_top10_year["whole_number"] &lt;- all_year["whole_number"]
never_top10_year %&gt;%
  mutate(never_top10_ratio = never_top10_number/whole_number) %&gt;%
  ggplot() +
  geom_col(aes(x=year, y=never_top10_ratio),fill="#125FA0", width = 0.7)+
  theme_classic()+
  labs(x="\nYear", y="Ratio of Never-Top10\n")
</code></pre>

<p><img src="https://i.postimg.cc/0j7gsVWT/unnamed-chunk-7-1.png" alt="" /></p>

<h4 id="what-were-the-top-10-songs-of-the-decade-2000-2009">What were the top 10 songs of the decade 2000-2009?</h4>

<pre><code class="language-{r}">df %&gt;%
  arrange(desc(total_points)) %&gt;%
  select(song_title, artist, year, total_points) %&gt;%
  head(10)
</code></pre>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## # A tibble: 10 x 4
##    song_title               artist                       year  total_points
##    &lt;chr&gt;                    &lt;chr&gt;                        &lt;fct&gt;        &lt;int&gt;
##  1 GLAMOROUS                FERGIE featuring LUDACRIS    2007          1335
##  2 BEFORE HE CHEATS         UNDERWOOD, CARRIE            2007          1192
##  3 NO SUCH THING            MAYER, JOHN                  2002          1167
##  4 CITY LOVE                MAYER, JOHN                  2003          1167
##  5 VIDEO                    INDIA.ARIE                   2002          1129
##  6 WHERE IS THE LOVE?       BLACK EYED PEAS featuring J… 2003          1111
##  7 TWO WEEKS FROM TWENTY    YELLOWCARD                   2005          1111
##  8 AMERICAN BOY             ESTELLE featuring KANYE WEST 2008          1072
##  9 TIME OF YOUR LIFE (GOOD… GREEN DAY                    2006          1040
## 10 SOMEONE TO CALL MY LOVER JACKSON, JANET               2001          1012
</code></pre></div></div>

<h4 id="who-was-the-top-artist-of-the-decade-2000-2009">Who was the top artist of the decade 2000-2009?</h4>

<p>(Who were the top 10 artists of the decade 2000-2009?)</p>

<pre><code class="language-{r}">df %&gt;%
  group_by(artist) %&gt;%
  summarise(sum_total_points = sum(total_points, na.rm = TRUE)) %&gt;%
  arrange(desc(sum_total_points)) %&gt;%
  head(10)
</code></pre>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## # A tibble: 10 x 2
##    artist             sum_total_points
##    &lt;chr&gt;                         &lt;int&gt;
##  1 MAYER, JOHN                    6861
##  2 JACKSON, JANET                 6049
##  3 PANIC AT THE DISCO             4572
##  4 BLACK EYED PEAS                4481
##  5 CAREY, MARIAH                  4470
##  6 GREEN DAY                      4378
##  7 CLARKSON, KELLY                4016
##  8 UNDERWOOD, CARRIE              3762
##  9 PINK                           3668
## 10 MAROON 5                       3604
</code></pre></div></div>

<h4 id="based-on-the-chart-data-what-artists-would-you-call-the-beatles-of-the-decade-2000-2009">Based on the chart data, what artist(s) would you call “The Beatles” of the decade 2000-2009?</h4>

<p>Actually, this question is really difficult to answer, because “The
Beatles” has various meanings according to different interpretations.</p>

<p>However, we can try to give some directions by analyzing the number of
songs on the chart and the mean point of the songs on the chart of each artist.</p>

<pre><code class="language-{r}">df %&gt;%
  group_by(artist) %&gt;%
  summarise(song_number = n()) %&gt;%
  arrange(desc(song_number)) %&gt;%
  head(10)
</code></pre>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## # A tibble: 10 x 2
##    artist              song_number
##    &lt;chr&gt;                     &lt;int&gt;
##  1 SPEARS, BRITNEY              21
##  2 PINK                         18
##  3 CAREY, MARIAH                14
##  4 CLARKSON, KELLY              14
##  5 EMINEM                       14
##  6 BEYONCE                      13
##  7 LAVIGNE, AVRIL               13
##  8 AGUILERA, CHRISTINA          12
##  9 MAYER, JOHN                  12
## 10 NELLY                        12
</code></pre></div></div>

<pre><code class="language-{r}">df %&gt;%
  group_by(artist) %&gt;%
  summarise(mean_total_points = mean(total_points)) %&gt;%
  arrange(desc(mean_total_points)) %&gt;%
  head(10)
</code></pre>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## # A tibble: 10 x 2
##    artist                                      mean_total_points
##    &lt;chr&gt;                                                   &lt;dbl&gt;
##  1 FERGIE featuring LUDACRIS                               1335
##  2 BLACK EYED PEAS featuring JUSTIN TIMBERLAKE             1111
##  3 ESTELLE featuring KANYE WEST                            1072
##  4 LOS LONELY BOYS                                          928
##  5 LOPEZ, JENNIFER featuring JA RULE                        861
##  6 SHAGGY featuring RICARDO DUCENT                          829
##  7 FOXX, JAMIE featuring T-PAIN                             808
##  8 POWTER, DANIEL                                           779
##  9 INDIA.ARIE                                               764.
## 10 EVE featuring GWEN STEFANI                               757
</code></pre></div></div>

<h4 id="what-was-the-most-commonly-used-word-in-a-song-title-for-the-decade-2000-2009">What was the most commonly used word in a song title for the decade 2000-2009?</h4>

<p>For this question, due to there are many special symbols in the song
title, I need to clean the special patterns in the title.</p>

<pre><code class="language-{r}">title_df &lt;- df["song_title"]
title_df &lt;- title_df %&gt;% mutate(song_title = str_to_lower(song_title))
title_df$song_title &lt;- gsub(pattern = "\\(", replacement =" ", title_df$song_title)
title_df$song_title &lt;- gsub(pattern = "\\)", replacement =" ", title_df$song_title)
title_df$song_title &lt;- gsub(pattern = ",", replacement =" ", title_df$song_title)
title_df$song_title &lt;- gsub(pattern = "n't", replacement =" not ", title_df$song_title)
title_df$song_title &lt;- gsub(pattern = "'s", replacement =" ", title_df$song_title)
title_df$song_title &lt;- gsub(pattern = "'re", replacement =" are ", title_df$song_title)
title_df$song_title &lt;- gsub(pattern = "'m", replacement =" am ", title_df$song_title)
title_df$song_title &lt;- gsub(pattern = "\\\"", replacement =" ", title_df$song_title)
title_df$song_title &lt;- gsub(pattern = "\\.", replacement =" ", title_df$song_title)
title_df$song_title &lt;- gsub(pattern = "-", replacement =" ", title_df$song_title)
title_df$song_title &lt;- gsub(pattern = "_", replacement =" ", title_df$song_title)
title_df$song_title &lt;- gsub(pattern = "!", replacement =" ", title_df$song_title)
title_df$song_title &lt;- gsub(pattern = "\\?", replacement =" ", title_df$song_title)
title_df$song_title &lt;- gsub(pattern = "…", replacement =" ", title_df$song_title)
title_df$song_title &lt;- gsub(pattern = "[0-9]", replacement =" ", title_df$song_title)
title_df$song_title &lt;- gsub(pattern = "/", replacement =" ", title_df$song_title)
title_df$song_title &lt;- gsub(pattern = "&amp;", replacement =" ", title_df$song_title)
title_df$song_title &lt;- gsub(pattern = "#", replacement =" ", title_df$song_title)
title_df$song_title &lt;- gsub(pattern = " +", replacement =" ", title_df$song_title)
</code></pre>

<p>Then make the data frame become list, which can help the following
steps.</p>

<pre><code class="language-{r}">title_list &lt;- title_df[["song_title"]]
</code></pre>

<p>Split all of the title into scattered words.</p>

<pre><code class="language-{r}">title_words &lt;- data.frame()
count &lt;- 1
for (i in title_list) {
  title_split &lt;- str_split(string = i, pattern = " ")
  for(j in title_split[[1]]){
    title_words[count,1] &lt;- j
    count &lt;- count + 1
  }
}
names(title_words) &lt;- "word"
</code></pre>

<p>Clean the different forms of the same word.</p>

<pre><code class="language-{r}">title_words &lt;- title_words %&gt;%
  mutate(word = case_when(word == "girls" ~ "girl",
                          word == "angels" ~ "angel",
                          word == "days" ~ "day",
                          word == "lovin'" ~ "love",
                          word == "loving" ~ "love",
                          word == "loved'" ~ "love",
                          word == "luv" ~ "love",
                          word == "waiting" ~ "wait",
                          word == "does" ~ "do",
                          word == "lights" ~ "light",
                          word == "things" ~ "thing",
                          word == "comes" ~ "come",
                          word == "dancing" ~ "dance",
                          word == "dancin'" ~ "dance",
                          word == "boys" ~ "boy",
                          word == "burning" ~ "burn",
                          word == "burnin'" ~ "burn",
                          word == "calle" ~ "call",
                          word == "called" ~ "call",
                          word == "calling" ~ "call",
                          word == "call" ~ "call",
                          TRUE ~ word))
</code></pre>

<p>Count the number of each word.</p>

<pre><code class="language-{r}">word_count &lt;- title_words %&gt;%
  filter(word != "") %&gt;%
  anti_join(stop_words,by = "word") %&gt;%
  group_by(word) %&gt;%
  summarise(number = n()) %&gt;%
  arrange(desc(number)) %&gt;%
  mutate(word = str_to_upper(word))
word_count
</code></pre>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## # A tibble: 1,192 x 2
##    word  number
##    &lt;chr&gt;  &lt;int&gt;
##  1 LOVE      87
##  2 GIRL      43
##  3 TIME      29
##  4 LIFE      21
##  5 DAY       20
##  6 WORLD     15
##  7 BABY      14
##  8 DANCE     14
##  9 ROCK      14
## 10 SONG      14
## # … with 1,182 more rows
</code></pre></div></div>

<p>Generate the word cloud by <code class="highlighter-rouge">wordcloud2</code> function.</p>

<pre><code class="language-{r}">wordcloud2(head(word_count,100),
           size = 1,
           fontFamily = "Montserrat",
           fontWeight = "Bold",
           minRotation = -pi/6,
           maxRotation = -pi/6,
           rotateRatio = 1,
           color = "#125FA0")
</code></pre>

<iframe src="https://waittim.github.io/gallery/song-wordcloud.html" frameborder="0" width="700" height="423" allowfullscreen="true" mozallowfullscreen="true" webkitallowfullscreen="true"></iframe>

<h4 id="sentiment-analysis-of-titles">Sentiment analysis of titles</h4>

<p>In order to analyze the sentiment of the words in the titles, I got the
stop words(meaningless words) dictionary and sentiment dictionary from
the <code class="highlighter-rouge">tidytext</code> library.</p>

<pre><code class="language-{r}">sentiments &lt;- get_sentiments("nrc")

df_sentiments &lt;- title_words %&gt;%
  filter(word != "") %&gt;%
  anti_join(stop_words,by = "word") %&gt;%
  left_join(sentiments)
</code></pre>

<pre><code class="language-{r}">df_sentiments_filtered &lt;- df_sentiments %&gt;%
  filter(!is.na(sentiment)) %&gt;%
  group_by(sentiment) %&gt;%
  summarize(n = n()) %&gt;%
  arrange(desc(n))
</code></pre>

<p>After removed the stop word, I counted the number of each word in the titles.</p>

<pre><code class="language-{r}">df_sentiments_filtered %&gt;%
  ggplot(aes(x = reorder(sentiment, n, function(n) -n), y = n)) +
  geom_bar(stat = "identity",fill="#125FA0", width = 0.7) +
  theme_classic() +
  labs(x = "\nSentiments", y="number\n")
</code></pre>

<p><img src="https://i.postimg.cc/hPqWrqhc/unnamed-chunk-19-1.png" alt="" /></p>

<p>And we can also count what is the percentage of positive words in the
words that have sentiments.</p>

<pre><code class="language-{r}">words_positive &lt;- df_sentiments %&gt;%
  filter(sentiment == "positive") %&gt;%
  group_by(word) %&gt;%
  summarise(n=n())

words_all_sentiment &lt;- df_sentiments %&gt;%
  filter(!is.na(sentiment)) %&gt;%
  group_by(word) %&gt;%
  summarize(n = n()) %&gt;%
  arrange(desc(n))

nrow(words_positive)/nrow(words_all_sentiment)
</code></pre>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] 0.4294671
</code></pre></div></div>

<h4 id="who-spent-the-most-weeks-at-1-for-the-decade-2000-2009">Who spent the most weeks at #1 for the decade 2000-2009?</h4>

<pre><code class="language-{r}">df %&gt;%
  group_by(artist) %&gt;%
  summarise(top1_time_sum = sum(weeks_at_number_1)) %&gt;%
  arrange(desc(top1_time_sum)) %&gt;%
  head(1)
</code></pre>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## # A tibble: 1 x 2
##   artist         top1_time_sum
##   &lt;chr&gt;                  &lt;int&gt;
## 1 JACKSON, JANET            39
</code></pre></div></div>

<p>And there are the songs belong to this artist.</p>

<pre><code class="language-{r}">df %&gt;%
  filter(artist == "JACKSON, JANET",
         weeks_at_number_1 != 0) %&gt;%
  arrange(desc(weeks_at_number_1)) %&gt;%
  select(song_title, artist, year, weeks_at_number_1)
</code></pre>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## # A tibble: 6 x 4
##   song_title                            artist       year  weeks_at_number…
##   &lt;chr&gt;                                 &lt;chr&gt;        &lt;fct&gt;            &lt;int&gt;
## 1 SOMEONE TO CALL MY LOVER              JACKSON, JA… 2001                10
## 2 ALL FOR YOU                           JACKSON, JA… 2001                10
## 3 "DOESN'T REALLY MATTER (from \"NUTTY… JACKSON, JA… 2000                 8
## 4 FEEDBACK                              JACKSON, JA… 2008                 6
## 5 SPECIAL                               JACKSON, JA… 2000                 3
## 6 LUV                                   JACKSON, JA… 2008                 2
</code></pre></div></div>

<h4 id="what-song-spent-the-most-weeks-at-1-for-the-decade-2000-2009">What song spent the most weeks at #1 for the decade 2000-2009?</h4>

<pre><code class="language-{r}">df %&gt;%
  arrange(desc(weeks_at_number_1)) %&gt;%
  select(song_title, artist, year, weeks_at_number_1) %&gt;%
  head(1)
</code></pre>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## # A tibble: 1 x 4
##   song_title    artist      year  weeks_at_number_1
##   &lt;chr&gt;         &lt;chr&gt;       &lt;fct&gt;             &lt;int&gt;
## 1 NO SUCH THING MAYER, JOHN 2002                 13
</code></pre></div></div>

<h4 id="what-song-peaked-at-1-the-quickest-in-the-decade-2000-2009">What song peaked at #1 the quickest in the decade 2000-2009?</h4>

<pre><code class="language-{r}">df %&gt;%
  filter(weeks_at_number_1 != 0) %&gt;%
  arrange(weeks_to_reach_peak) %&gt;%
  select(song_title, artist, year, weeks_at_number_1, weeks_to_reach_peak, debut_date, peak_date) %&gt;%
  head(1)
</code></pre>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## # A tibble: 1 x 7
##   song_title artist year  weeks_at_number… weeks_to_reach_… debut_date
##   &lt;chr&gt;      &lt;chr&gt;  &lt;fct&gt;            &lt;int&gt;            &lt;int&gt; &lt;date&gt;    
## 1 SOMEONE T… JACKS… 2001                10                2 2001-07-22
## # … with 1 more variable: peak_date &lt;date&gt;
</code></pre></div></div>

<h4 id="what-song-took-the-longest-to-reach-1-in-the-decade-2000-2009">What song took the longest to reach #1 in the decade 2000-2009?</h4>

<pre><code class="language-{r}">df %&gt;%
  filter(weeks_at_number_1 != 0) %&gt;%
  arrange(desc(weeks_to_reach_peak)) %&gt;%
  select(song_title, artist, year, weeks_at_number_1, weeks_to_reach_peak, debut_date, peak_date) %&gt;%
  head(1)
</code></pre>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## # A tibble: 1 x 7
##   song_title artist year  weeks_at_number… weeks_to_reach_… debut_date
##   &lt;chr&gt;      &lt;chr&gt;  &lt;fct&gt;            &lt;int&gt;            &lt;int&gt; &lt;date&gt;    
## 1 BEFORE HE… UNDER… 2007                 3               31 2006-11-05
## # … with 1 more variable: peak_date &lt;date&gt;
</code></pre></div></div>

<h4 id="solo-men-solo-women-groups-for-the-decade-2000-2009---design-a-graphic-that-shows-the-distribution-of-songs-hitting-1">Solo men, solo women, groups for the decade 2000-2009 - design a graphic that shows the distribution of songs hitting #1</h4>

<p>The solo artists have their full name in the data by the format as
“LastName, FirstName”, as a result, we can tell whether the data is a
single person name by the presence of a comma.</p>

<pre><code class="language-{r}">df %&gt;%
  mutate(solo_group = case_when(str_detect(string = artist, pattern = ",") ~ "solo",
                                TRUE ~ "group")) %&gt;%
  mutate(solo_group = as.factor(solo_group)) %&gt;%
  filter(weeks_at_number_1 != 0) %&gt;%
  group_by(solo_group) %&gt;%
  summarise(number = n())
</code></pre>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## # A tibble: 2 x 2
##   solo_group number
##   &lt;fct&gt;       &lt;int&gt;
## 1 group          92
## 2 solo           84
</code></pre></div></div>

<p>Actually, there is no built-in pie chart function in <code class="highlighter-rouge">ggplot2</code>. But we
can use bar chart function then twisting the y-axis to the polar
coordinate system to create a pie chart.</p>

<pre><code class="language-{r}">df %&gt;%
  mutate(solo_group = case_when(str_detect(string = artist, pattern = ",") ~ "solo",
                                TRUE ~ "group")) %&gt;%
  mutate(solo_group = as.factor(solo_group)) %&gt;%
  filter(weeks_at_number_1 != 0) %&gt;%
  ggplot()+
  geom_bar(aes(x=1, fill = solo_group))+
  coord_polar(theta = "y")+
  theme(axis.text = element_blank(),
        axis.title = element_blank(),
        axis.ticks = element_blank(),
        axis.line = element_blank(),
        legend.title = element_blank(),
        panel.background = element_blank()
        )+
  scale_fill_brewer(palette = "Paired")
</code></pre>

<p><img src="https://i.postimg.cc/fWdQmbz8/unnamed-chunk-27-1.png" alt="" /></p>

<h4 id="solo-men-solo-women-groups-for-the-decade-2000-2009---design-a-graphic-that-shows-the-distribution-of-songs-hitting-the-top-10">Solo men, solo women, groups for the decade 2000-2009 - design a graphic that shows the distribution of songs hitting the Top 10</h4>

<pre><code class="language-{r}">df %&gt;%
  mutate(solo_group = case_when(str_detect(string = artist, pattern = ",") ~ "solo",
                                TRUE ~ "group")) %&gt;%
  mutate(solo_group = as.factor(solo_group)) %&gt;%
  filter(weeks_top_10 != 0) %&gt;%
  group_by(solo_group) %&gt;%
  summarise(number = n())
</code></pre>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## # A tibble: 2 x 2
##   solo_group number
##   &lt;fct&gt;       &lt;int&gt;
## 1 group         318
## 2 solo          255
</code></pre></div></div>

<pre><code class="language-{r}">df %&gt;%
  mutate(solo_group = case_when(str_detect(string = artist, pattern = ",") ~ "solo",
                                TRUE ~ "group")) %&gt;%
  mutate(solo_group = as.factor(solo_group)) %&gt;%
  filter(weeks_top_10 != 0) %&gt;%
  ggplot()+
  geom_bar(aes(x=1, fill = solo_group))+
  coord_polar(theta = "y")+
  theme(axis.text = element_blank(),
        axis.title = element_blank(),
        axis.ticks = element_blank(),
        axis.line = element_blank(),
        legend.title = element_blank(),
        panel.background = element_blank()
        )+
  scale_fill_brewer(palette = "Paired")
</code></pre>

<p><img src="https://i.postimg.cc/ncY8SwQ7/unnamed-chunk-29-1.png" alt="" /></p>

<h4 id="what-song-spent-the-most-time-on-the-charts-in-the-decade-2000-2009">What song spent the most time on the charts in the decade 2000-2009)</h4>

<pre><code class="language-{r}">df %&gt;%
  arrange(desc(weeks_top_50)) %&gt;%
  select(song_title, artist, year, weeks_top_50) %&gt;%
  head(3)
</code></pre>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## # A tibble: 3 x 4
##   song_title                      artist                 year  weeks_top_50
##   &lt;chr&gt;                           &lt;chr&gt;                  &lt;fct&gt;        &lt;int&gt;
## 1 TIME OF YOUR LIFE (GOOD RIDDAN… GREEN DAY              2006            65
## 2 BEFORE HE CHEATS                UNDERWOOD, CARRIE      2007            57
## 3 GLAMOROUS                       FERGIE featuring LUDA… 2007            50
</code></pre></div></div>

<p>Actually, TIME OF YOUR LIFE (GOOD RIDDANCE) never be the top 1. A sad
story.</p>

<h4 id="is-there-a-correlation-between-weeks-spent-on-the-chart-and-weeks-at-1">Is there a correlation between weeks spent on the chart and weeks at #1?</h4>

<pre><code class="language-{r}">cor(x = df[["weeks_at_number_1"]],
    y = df[["weeks_top_50"]])
</code></pre>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] 0.471703
</code></pre></div></div>

<pre><code class="language-{r}">df %&gt;%
  ggplot(aes(x=weeks_at_number_1, y=weeks_top_50))+
  geom_jitter(alpha = 0.3, color = "dodgerblue4")+
  geom_smooth(color = "dodgerblue4", se = FALSE)+
  theme_classic()+
  labs(x="\nWeeks at Top 1", y="Weeks at Top 50\n")
</code></pre>

<p><img src="https://i.postimg.cc/7ZxFFMgR/unnamed-chunk-32-1.png" alt="" /></p>

<p><em>Hint: Project GitHub page: <a href="https://github.com/waittim/Cashbox-Magazine-song-records-Analysis">Cashbox-Magazine-song-records-Analysis</a></em></p>


                <hr style="visibility: hidden;">

                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/2019/12/12/h1b-analysis/" data-toggle="tooltip" data-placement="top" title="Think and Get Jobs - H1B Visa Analysis">
                        Previous<br>
                        <span>Think and Get Jobs - H1B Visa Analysis</span>
                        </a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/2020/02/19/LAPOP-dashboard/" data-toggle="tooltip" data-placement="top" title="LAPOP Data Dashboard">
                        Next<br>
                        <span>LAPOP Data Dashboard</span>
                        </a>
                    </li>
                    
                </ul>


                <!--Gitalk评论start  -->
                
                <!-- 引入Gitalk评论插件  -->
                <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
                <script src="https://unpkg.com/gitalk@latest/dist/gitalk.min.js"></script>
                <div id="gitalk-container"></div>
                <!-- 引入一个生产md5的js，用于对id值进行处理，防止其过长 -->
                <!-- Thank DF:https://github.com/NSDingFan/NSDingFan.github.io/issues/3#issuecomment-407496538 -->
                <script src="/js/md5.min.js"></script>
                <script type="text/javascript">
                    var gitalk = new Gitalk({
                    clientID: '491d9ec79c30f63d6dfb',
                    clientSecret: 'e00b92b47fb3a2f6d0bf024cea6ef6a0fc44e165',
                    repo: 'waittim.github.io',
                    owner: 'waittim',
                    admin: ['waittim'],
                    distractionFreeMode: true,
                    id: md5(location.pathname),
                    });
                    gitalk.render('gitalk-container');
                </script>
                
                <!-- Gitalk end -->

                

            </div>

    <!-- Side Catalog Container -->
        
            <div class="
                col-lg-2 col-lg-offset-0
                visible-lg-block
                sidebar-container
                catalog-container">
                <div class="side-catalog">
                    <hr class="hidden-sm hidden-xs">
                    <h5>
                        <a class="catalog-toggle" href="#">CATALOG</a>
                    </h5>
                    <ul class="catalog-body"></ul>
                </div>
            </div>
        

    <!-- Sidebar Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                sidebar-container">

                <!-- Featured Tags -->
                
                <section>
                    <hr class="hidden-sm hidden-xs">
                    <h5><a href="/tags/">FEATURED TAGS</a></h5>
                    <div class="tags">
        				
                            
                				<a href="/tags/#Probability" title="Probability" rel="9">
                                    Probability
                                </a>
                            
        				
                            
                				<a href="/tags/#Simulation" title="Simulation" rel="9">
                                    Simulation
                                </a>
                            
        				
                            
                				<a href="/tags/#R" title="R" rel="14">
                                    R
                                </a>
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
                				<a href="/tags/#EDA" title="EDA" rel="4">
                                    EDA
                                </a>
                            
        				
                            
                				<a href="/tags/#Project" title="Project" rel="5">
                                    Project
                                </a>
                            
        				
                            
                				<a href="/tags/#Python" title="Python" rel="5">
                                    Python
                                </a>
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
                				<a href="/tags/#Deep Learning" title="Deep Learning" rel="4">
                                    Deep Learning
                                </a>
                            
        				
                            
        				
                            
        				
                            
                				<a href="/tags/#C++" title="C++" rel="3">
                                    C++
                                </a>
                            
        				
                            
        				
                            
        				
        			</div>
                </section>
                

                <!-- Friends Blog -->
                
                <hr>
                <h5>FRIENDS</h5>
                <ul class="list-inline">
                    
                        <li><a href="https://www.vanderbilt.edu/datascience/">Data Science | Vanderbilt</a></li>
                    
                        <li><a href="https://www.linkedin.com/in/zekun-wang/">LinkedIn | Zekun Wang</a></li>
                    
                </ul>
                
            </div>
        </div>
    </div>
</article>






<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>
<!-- anchor-js, Doc:http://bryanbraun.github.io/anchorjs/ -->
<script>
    async("//cdnjs.cloudflare.com/ajax/libs/anchor-js/1.1.1/anchor.min.js",function(){
        // BY Fix:去除标题前的‘#’ issues:<https://github.com/qiubaiying/qiubaiying.github.io/issues/137>
        // anchors.options = {
        //   visible: 'always',
        //   placement: 'right',
        //   icon: '#'
        // };
        anchors.add().remove('.intro-header h1').remove('.subheading').remove('.sidebar-container h5');
    })
</script>
<style>
    /* place left on bigger screen */
    @media all and (min-width: 800px) {
        .anchorjs-link{
            position: absolute;
            left: -0.75em;
            font-size: 1.1em;
            margin-top : -0.1em;
        }
    }
</style>



    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    
                    <!-- add jianshu add target = "_blank" to <a> by BY -->
                    
                    

                    <!-- add Weibo, Zhihu by Hux, add target = "_blank" to <a> by Hux -->
                    
                    


                    
                    
                    <li>
                        <a target="_blank" href="https://github.com/waittim">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                </ul>
                <p class="copyright text-muted">
                    Copyright &copy; Zekun Blog 2020
                    <br>
                    Theme on <a href="https://github.com/waittim/waittim.github.io.git">GitHub</a> |
                    <iframe
                        style="margin-left: 2px; margin-bottom:-5px;"
                        frameborder="0" scrolling="0" width="100px" height="20px"
                        src="https://ghbtns.com/github-btn.html?user=waittim&repo=waittim.github.io&type=star&count=true" >
                    </iframe>
                </p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js "></script>

<!-- Bootstrap Core JavaScript -->
<script src="/js/bootstrap.min.js "></script>

<!-- Custom Theme JavaScript -->
<script src="/js/hux-blog.min.js "></script>

<!-- Service Worker -->

<script type="text/javascript">
    if(navigator.serviceWorker){
        // For security reasons, a service worker can only control the pages that are in the same directory level or below it. That's why we put sw.js at ROOT level.
        navigator.serviceWorker
            .register('/sw.js')
            .then((registration) => {console.log('Service Worker Registered. ', registration)})
            .catch((error) => {console.log('ServiceWorker registration failed: ', error)})
    }
</script>



<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>

<!-- 
     Because of the native support for backtick-style fenced code blocks 
     right within the Markdown is landed in Github Pages, 
     From V1.6, There is no need for Highlight.js, 
     so Huxblog drops it officially.

     - https://github.com/blog/2100-github-pages-now-faster-and-simpler-with-jekyll-3-0  
     - https://help.github.com/articles/creating-and-highlighting-code-blocks/ 
     - https://github.com/jneen/rouge/wiki/list-of-supported-languages-and-lexers   
-->
<!--
    <script>
        async("http://cdn.bootcss.com/highlight.js/8.6/highlight.min.js", function(){
            hljs.initHighlightingOnLoad();
        })
    </script>
    <link href="http://cdn.bootcss.com/highlight.js/8.6/styles/github.min.css" rel="stylesheet">
-->


<!-- jquery.tagcloud.js -->
<script>
    // only load tagcloud.js in tag.html
    if($('#tag_cloud').length !== 0){
        async('/js/jquery.tagcloud.js',function(){
            $.fn.tagcloud.defaults = {
                //size: {start: 1, end: 1, unit: 'em'},
                color: {start: '#bbbbee', end: '#0085a1'},
            };
            $('#tag_cloud a').tagcloud();
        })
    }
</script>

<!--fastClick.js -->
<script>
    async("//cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.min.js", function(){
        var $nav = document.querySelector("nav");
        if($nav) FastClick.attach($nav);
    })
</script>


<!-- Google Analytics -->

<script>
    // dynamic User by Hux
    var _gaId = 'UA-154878163-1';
    var _gaDomain = 'auto';

    // Originial
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', _gaId, _gaDomain);
    ga('send', 'pageview');
</script>



<!-- Baidu Tongji -->




<!-- Side Catalog -->

<script type="text/javascript">
    function generateCatalog (selector) {
        var P = $('div.post-container'),a,n,t,l,i,c;
        a = P.find('h1,h2,h3,h4,h5,h6');
        a.each(function () {
            n = $(this).prop('tagName').toLowerCase();
            i = "#"+$(this).prop('id');
            t = $(this).text();
            c = $('<a href="'+i+'" rel="nofollow">'+t+'</a>');
            l = $('<li class="'+n+'_nav"></li>').append(c);
            $(selector).append(l);
        });
        return true;    
    }

    generateCatalog(".catalog-body");

    // toggle side catalog
    $(".catalog-toggle").click((function(e){
        e.preventDefault();
        $('.side-catalog').toggleClass("fold")
    }))

    /*
     * Doc: https://github.com/davist11/jQuery-One-Page-Nav
     * Fork by Hux to support padding
     */
    async("/js/jquery.nav.js", function () {
        $('.catalog-body').onePageNav({
            currentClass: "active",
            changeHash: !1,
            easing: "swing",
            filter: "",
            scrollSpeed: 700,
            scrollOffset: 0,
            scrollThreshold: .2,
            begin: null,
            end: null,
            scrollChange: null,
            padding: 80
        });
    });
</script>





<!-- Image to hack wechat -->
<img src="/img/apple-touch-icon.png" width="0" height="0" />
<!-- Migrate from head to bottom, no longer block render and still work -->

</body>

</html>
