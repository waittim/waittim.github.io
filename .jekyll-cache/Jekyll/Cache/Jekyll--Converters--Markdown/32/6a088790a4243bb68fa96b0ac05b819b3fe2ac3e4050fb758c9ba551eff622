I"ÿÈ<hr />
<p>title: â€œRoulette Gameâ€
output: html_notebook
â€”</p>

<p><img src="https://upload.wikimedia.org/wikipedia/commons/5/5d/13-02-27-spielbank-wiesbaden-by-RalfR-094.jpg" alt="Roulette" title="Roulette" /></p>

<blockquote>
  <p>Roulette is a casino game named after the French word meaning little wheel. In the game, players may choose to place bets on either a single number, various groupings of numbers, the colors red or black, whether the number is odd or even, or if the numbers are high (19â€“36) or low (1â€“18).
<em>From <a href="https://en.wikipedia.org/wiki/Roulette">Wikipedia-Roulette</a></em></p>
</blockquote>

<hr />
<p>This time we will talk about a kind of simplified Roulette, which wonâ€™t be influenced by the number on roulette but only be divided into two parts, win or lose.</p>

<p>In order to use pipes â€œ%&gt;%â€ in code, we need to import package first.</p>
<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="n">dplyr</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>
<p>Â </p>

<p>To play the game successfully and avoid owing unrealistic debt, we need to set some parameter at first. These parameter will be save in a state list.</p>

<table>
  <thead>
    <tr>
      <th>Parameter</th>
      <th>Type</th>
      <th>Explaination</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>B</td>
      <td>number</td>
      <td>the budget</td>
    </tr>
    <tr>
      <td>W</td>
      <td>number</td>
      <td>the budget threshold for successfully stoping</td>
    </tr>
    <tr>
      <td>L</td>
      <td>number</td>
      <td>the maximum number of plays</td>
    </tr>
    <tr>
      <td>M</td>
      <td>number</td>
      <td>the casino wager limit</td>
    </tr>
    <tr>
      <td>plays</td>
      <td>integer</td>
      <td>the number of plays executed</td>
    </tr>
    <tr>
      <td>previous_wager</td>
      <td>number</td>
      <td>the wager in the previous play (0 at first play)</td>
    </tr>
    <tr>
      <td>previous_win</td>
      <td>TRUE/FALSE</td>
      <td>indicator if the previous play was a win (TRUE at first play)</td>
    </tr>
  </tbody>
</table>

<p>Then, letâ€™s define the process of one play.</p>
<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w"> </span><span class="n">one_play</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">state</span><span class="p">){</span><span class="w">

    </span><span class="c1"># Wager</span><span class="w">
    </span><span class="n">proposed_wager</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ifelse</span><span class="p">(</span><span class="n">state</span><span class="o">$</span><span class="n">previous_win</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="o">*</span><span class="n">state</span><span class="o">$</span><span class="n">previous_wager</span><span class="p">)</span><span class="w">
    </span><span class="n">wager</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">min</span><span class="p">(</span><span class="n">proposed_wager</span><span class="p">,</span><span class="w"> </span><span class="n">state</span><span class="o">$</span><span class="n">M</span><span class="p">,</span><span class="w"> </span><span class="n">state</span><span class="o">$</span><span class="n">B</span><span class="p">)</span><span class="w">

    </span><span class="c1"># Spin of the wheel</span><span class="w">
    </span><span class="n">red</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">rbinom</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">18</span><span class="o">/</span><span class="m">38</span><span class="p">)</span><span class="w">

    </span><span class="c1"># Update state</span><span class="w">
    </span><span class="n">state</span><span class="o">$</span><span class="n">plays</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">state</span><span class="o">$</span><span class="n">plays</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">1</span><span class="w">
    </span><span class="n">state</span><span class="o">$</span><span class="n">previous_wager</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">wager</span><span class="w">
    </span><span class="k">if</span><span class="p">(</span><span class="n">red</span><span class="p">){</span><span class="w">
      </span><span class="c1"># WIN</span><span class="w">
      </span><span class="n">state</span><span class="o">$</span><span class="n">B</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">state</span><span class="o">$</span><span class="n">B</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">wager</span><span class="w">
      </span><span class="n">state</span><span class="o">$</span><span class="n">previous_win</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kc">TRUE</span><span class="w">
    </span><span class="p">}</span><span class="k">else</span><span class="p">{</span><span class="w">
      </span><span class="c1"># LOSE</span><span class="w">
      </span><span class="n">state</span><span class="o">$</span><span class="n">B</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">state</span><span class="o">$</span><span class="n">B</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">wager</span><span class="w">
      </span><span class="n">state</span><span class="o">$</span><span class="n">previous_win</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kc">FALSE</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="n">state</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>
<p>Â </p>

<p>When the player run out of the money or win enough money or play enough times, we need to stop the game by set up an stop function.</p>
<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">stop_play</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">state</span><span class="p">){</span><span class="w">
  </span><span class="k">if</span><span class="p">(</span><span class="n">state</span><span class="o">$</span><span class="n">B</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="nf">return</span><span class="p">(</span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
  </span><span class="k">if</span><span class="p">(</span><span class="n">state</span><span class="o">$</span><span class="n">plays</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">state</span><span class="o">$</span><span class="n">L</span><span class="p">)</span><span class="w"> </span><span class="nf">return</span><span class="p">(</span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
  </span><span class="k">if</span><span class="p">(</span><span class="n">state</span><span class="o">$</span><span class="n">B</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">state</span><span class="o">$</span><span class="n">W</span><span class="p">)</span><span class="w"> </span><span class="nf">return</span><span class="p">(</span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
  </span><span class="kc">FALSE</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>
<p>Â </p>

<p>Next, we need to play the game under our rules as a series. The function will output a budget list to record the money value after every play.</p>
<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">one_series</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="w">
    </span><span class="n">B</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">200</span><span class="w">
  </span><span class="p">,</span><span class="w"> </span><span class="n">W</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">300</span><span class="w">
  </span><span class="p">,</span><span class="w"> </span><span class="n">L</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1000</span><span class="w">
  </span><span class="p">,</span><span class="w"> </span><span class="n">M</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">100</span><span class="w">
</span><span class="p">){</span><span class="w">

  </span><span class="c1"># initial state</span><span class="w">
  </span><span class="n">state</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="w">
    </span><span class="n">B</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">B</span><span class="w">
  </span><span class="p">,</span><span class="w"> </span><span class="n">W</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">W</span><span class="w">
  </span><span class="p">,</span><span class="w"> </span><span class="n">L</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">L</span><span class="w">
  </span><span class="p">,</span><span class="w"> </span><span class="n">M</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">M</span><span class="w">
  </span><span class="p">,</span><span class="w"> </span><span class="n">plays</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="w">
  </span><span class="p">,</span><span class="w"> </span><span class="n">previous_wager</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="w">
  </span><span class="p">,</span><span class="w"> </span><span class="n">previous_win</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="w">
  </span><span class="p">)</span><span class="w">

  </span><span class="c1"># vector to store budget over series of plays</span><span class="w">
  </span><span class="n">budget</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rep</span><span class="p">(</span><span class="kc">NA</span><span class="p">,</span><span class="w"> </span><span class="n">L</span><span class="p">)</span><span class="w">

  </span><span class="c1"># For loop of plays</span><span class="w">
  </span><span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="n">L</span><span class="p">){</span><span class="w">
    </span><span class="n">new_state</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">one_play</span><span class="w">
    </span><span class="n">budget</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">new_state</span><span class="o">$</span><span class="n">B</span><span class="w">
    </span><span class="k">if</span><span class="p">(</span><span class="n">new_state</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">stop_play</span><span class="p">){</span><span class="w">
      </span><span class="nf">return</span><span class="p">(</span><span class="n">budget</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="n">i</span><span class="p">])</span><span class="w">
    </span><span class="p">}</span><span class="w">
    </span><span class="n">state</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">new_state</span><span class="w">
  </span><span class="p">}</span><span class="w">
  </span><span class="n">budget</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>
<p>Â </p>

<p>Then we can get the final result of this series of play.</p>
<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># helper function</span><span class="w">
</span><span class="n">get_last</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="n">x</span><span class="p">[</span><span class="nf">length</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span><span class="w">
</span><span class="n">get_series</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="n">x</span><span class="w">
</span></code></pre></div></div>
<p>Â </p>

<p>In order to figure out the generalized result, we need to repeat the process for a huge number of times then try to find out the distribution and other characteristics of results.</p>
<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Simulation</span><span class="w">
</span><span class="n">walk_out_money</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rep</span><span class="p">(</span><span class="kc">NA</span><span class="p">,</span><span class="w"> </span><span class="m">1000</span><span class="p">)</span><span class="w">
</span><span class="k">for</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nf">seq_along</span><span class="p">(</span><span class="n">walk_out_money</span><span class="p">)){</span><span class="w">
  </span><span class="n">walk_out_money</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">one_series</span><span class="p">(</span><span class="n">B</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">200</span><span class="p">,</span><span class="w"> </span><span class="n">W</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">300</span><span class="p">,</span><span class="w"> </span><span class="n">L</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1000</span><span class="p">,</span><span class="w"> </span><span class="n">M</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">100</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">get_last</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="c1"># Walk out money distribution</span><span class="w">
</span><span class="n">hist</span><span class="p">(</span><span class="n">walk_out_money</span><span class="p">,</span><span class="w"> </span><span class="n">breaks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">100</span><span class="p">)</span><span class="w">

</span><span class="c1"># Estimated probability of walking out with extra cash</span><span class="w">
</span><span class="n">mean</span><span class="p">(</span><span class="n">walk_out_money</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">200</span><span class="p">)</span><span class="w">

</span><span class="c1"># Estimated earnings</span><span class="w">
</span><span class="n">mean</span><span class="p">(</span><span class="n">walk_out_money</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">200</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>
<p>Â </p>

<hr />
<p>In this graph, we can see how the budget changes during in one series.</p>
<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">budget_list</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">one_series</span><span class="p">(</span><span class="n">B</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">200</span><span class="p">,</span><span class="w"> </span><span class="n">W</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">300</span><span class="p">,</span><span class="w"> </span><span class="n">L</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1000</span><span class="p">,</span><span class="w"> </span><span class="n">M</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">100</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">get_series</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">budget_list</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="s2">"line"</span><span class="p">,</span><span class="w"> </span><span class="n">xlim</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">500</span><span class="p">),</span><span class="w"> </span><span class="n">ylim</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">300</span><span class="p">),</span><span class="w"> </span><span class="n">xlab</span><span class="o">=</span><span class="s2">"play number"</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="o">=</span><span class="s2">"earning money"</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="o">=</span><span class="s2">"budget series"</span><span class="p">,</span><span class="n">col</span><span class="o">=</span><span class="s2">"red"</span><span class="p">)</span><span class="w">
</span><span class="n">par</span><span class="p">(</span><span class="n">new</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
</span><span class="n">budget_list</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">one_series</span><span class="p">(</span><span class="n">B</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">200</span><span class="p">,</span><span class="w"> </span><span class="n">W</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">300</span><span class="p">,</span><span class="w"> </span><span class="n">L</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1000</span><span class="p">,</span><span class="w"> </span><span class="n">M</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">100</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">get_series</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">budget_list</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="s2">"line"</span><span class="p">,</span><span class="w"> </span><span class="n">xlim</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">500</span><span class="p">),</span><span class="w"> </span><span class="n">ylim</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">300</span><span class="p">),</span><span class="w"> </span><span class="n">xlab</span><span class="o">=</span><span class="s2">"play number"</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="o">=</span><span class="s2">"earning money"</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="o">=</span><span class="s2">"budget series"</span><span class="p">,</span><span class="n">col</span><span class="o">=</span><span class="s2">"orange"</span><span class="p">)</span><span class="w">
</span><span class="n">par</span><span class="p">(</span><span class="n">new</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
</span><span class="n">budget_list</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">one_series</span><span class="p">(</span><span class="n">B</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">200</span><span class="p">,</span><span class="w"> </span><span class="n">W</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">300</span><span class="p">,</span><span class="w"> </span><span class="n">L</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1000</span><span class="p">,</span><span class="w"> </span><span class="n">M</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">100</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">get_series</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">budget_list</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="s2">"line"</span><span class="p">,</span><span class="w"> </span><span class="n">xlim</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">500</span><span class="p">),</span><span class="w"> </span><span class="n">ylim</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">300</span><span class="p">),</span><span class="w"> </span><span class="n">xlab</span><span class="o">=</span><span class="s2">"play number"</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="o">=</span><span class="s2">"earning money"</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="o">=</span><span class="s2">"budget series"</span><span class="p">,</span><span class="n">col</span><span class="o">=</span><span class="s2">"yellow"</span><span class="p">)</span><span class="w">
</span><span class="n">par</span><span class="p">(</span><span class="n">new</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
</span><span class="n">budget_list</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">one_series</span><span class="p">(</span><span class="n">B</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">200</span><span class="p">,</span><span class="w"> </span><span class="n">W</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">300</span><span class="p">,</span><span class="w"> </span><span class="n">L</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1000</span><span class="p">,</span><span class="w"> </span><span class="n">M</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">100</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">get_series</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">budget_list</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="s2">"line"</span><span class="p">,</span><span class="w"> </span><span class="n">xlim</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">500</span><span class="p">),</span><span class="w"> </span><span class="n">ylim</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">300</span><span class="p">),</span><span class="w"> </span><span class="n">xlab</span><span class="o">=</span><span class="s2">"play number"</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="o">=</span><span class="s2">"earning money"</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="o">=</span><span class="s2">"budget series"</span><span class="p">,</span><span class="n">col</span><span class="o">=</span><span class="s2">"green"</span><span class="p">)</span><span class="w">
</span><span class="n">par</span><span class="p">(</span><span class="n">new</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
</span><span class="n">budget_list</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">one_series</span><span class="p">(</span><span class="n">B</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">200</span><span class="p">,</span><span class="w"> </span><span class="n">W</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">300</span><span class="p">,</span><span class="w"> </span><span class="n">L</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1000</span><span class="p">,</span><span class="w"> </span><span class="n">M</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">100</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">get_series</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">budget_list</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="s2">"line"</span><span class="p">,</span><span class="w"> </span><span class="n">xlim</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">500</span><span class="p">),</span><span class="w"> </span><span class="n">ylim</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">300</span><span class="p">),</span><span class="w"> </span><span class="n">xlab</span><span class="o">=</span><span class="s2">"play number"</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="o">=</span><span class="s2">"earning money"</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="o">=</span><span class="s2">"budget series"</span><span class="p">,</span><span class="n">col</span><span class="o">=</span><span class="s2">"gray"</span><span class="p">)</span><span class="w">
</span><span class="n">par</span><span class="p">(</span><span class="n">new</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
</span><span class="n">budget_list</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">one_series</span><span class="p">(</span><span class="n">B</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">200</span><span class="p">,</span><span class="w"> </span><span class="n">W</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">300</span><span class="p">,</span><span class="w"> </span><span class="n">L</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1000</span><span class="p">,</span><span class="w"> </span><span class="n">M</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">100</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">get_series</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">budget_list</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="s2">"line"</span><span class="p">,</span><span class="w"> </span><span class="n">xlim</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">500</span><span class="p">),</span><span class="w"> </span><span class="n">ylim</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">300</span><span class="p">),</span><span class="w"> </span><span class="n">xlab</span><span class="o">=</span><span class="s2">"play number"</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="o">=</span><span class="s2">"earning money"</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="o">=</span><span class="s2">"budget series"</span><span class="p">,</span><span class="n">col</span><span class="o">=</span><span class="s2">"blue"</span><span class="p">)</span><span class="w">
</span><span class="n">par</span><span class="p">(</span><span class="n">new</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
</span><span class="n">budget_list</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">one_series</span><span class="p">(</span><span class="n">B</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">200</span><span class="p">,</span><span class="w"> </span><span class="n">W</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">300</span><span class="p">,</span><span class="w"> </span><span class="n">L</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1000</span><span class="p">,</span><span class="w"> </span><span class="n">M</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">100</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">get_series</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">budget_list</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="s2">"line"</span><span class="p">,</span><span class="w"> </span><span class="n">xlim</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">500</span><span class="p">),</span><span class="w"> </span><span class="n">ylim</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">300</span><span class="p">),</span><span class="w"> </span><span class="n">xlab</span><span class="o">=</span><span class="s2">"play number"</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="o">=</span><span class="s2">"earning money"</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="o">=</span><span class="s2">"budget series"</span><span class="p">,</span><span class="n">col</span><span class="o">=</span><span class="s2">"purple"</span><span class="p">)</span><span class="w">


</span></code></pre></div></div>
<p>Â </p>

<table>
  <thead>
    <tr>
      <th>Parameter</th>
      <th>Type</th>
      <th>Explaination</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>B</td>
      <td>number</td>
      <td>the budget</td>
    </tr>
    <tr>
      <td>W</td>
      <td>number</td>
      <td>the budget threshold for successfully stoping</td>
    </tr>
    <tr>
      <td>L</td>
      <td>number</td>
      <td>the maximum number of plays</td>
    </tr>
    <tr>
      <td>M</td>
      <td>number</td>
      <td>the casino wager limit</td>
    </tr>
  </tbody>
</table>

<p>When B changes, what is the mean earning.</p>
<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">earning_series</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rep</span><span class="p">(</span><span class="kc">NA</span><span class="p">,</span><span class="m">20</span><span class="p">)</span><span class="w">
</span><span class="k">for</span><span class="p">(</span><span class="n">B</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">seq</span><span class="p">(</span><span class="m">100</span><span class="p">,</span><span class="m">1000</span><span class="p">,</span><span class="n">by</span><span class="o">=</span><span class="m">50</span><span class="p">)){</span><span class="w">
</span><span class="n">walk_out_money</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rep</span><span class="p">(</span><span class="kc">NA</span><span class="p">,</span><span class="w"> </span><span class="m">1000</span><span class="p">)</span><span class="w">
</span><span class="k">for</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nf">seq_along</span><span class="p">(</span><span class="n">walk_out_money</span><span class="p">)){</span><span class="w">
  </span><span class="n">walk_out_money</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">one_series</span><span class="p">(</span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">W</span><span class="o">=</span><span class="n">B</span><span class="m">+100</span><span class="p">,</span><span class="w"> </span><span class="n">L</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1000</span><span class="p">,</span><span class="w"> </span><span class="n">M</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">100</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">get_last</span><span class="w">
</span><span class="p">}</span><span class="w">
</span><span class="n">earning_series</span><span class="p">[</span><span class="n">B</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">mean</span><span class="p">(</span><span class="n">walk_out_money</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">B</span><span class="p">)</span><span class="o">/</span><span class="n">B</span><span class="w">
</span><span class="p">}</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">earning_series</span><span class="p">,</span><span class="n">xlab</span><span class="o">=</span><span class="s2">"Budget"</span><span class="p">,</span><span class="n">ylab</span><span class="o">=</span><span class="s2">"mean earning rate"</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="o">=</span><span class="s2">"How Budget influence earning?"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>
<p>Â </p>

<p>When W changes, what is the mean earning.</p>
<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">earning_series</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rep</span><span class="p">(</span><span class="kc">NA</span><span class="p">,</span><span class="m">20</span><span class="p">)</span><span class="w">
</span><span class="k">for</span><span class="p">(</span><span class="n">W</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">seq</span><span class="p">(</span><span class="m">100</span><span class="p">,</span><span class="m">1000</span><span class="p">,</span><span class="n">by</span><span class="o">=</span><span class="m">50</span><span class="p">)){</span><span class="w">
</span><span class="n">walk_out_money</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rep</span><span class="p">(</span><span class="kc">NA</span><span class="p">,</span><span class="w"> </span><span class="m">10000</span><span class="p">)</span><span class="w">
</span><span class="k">for</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nf">seq_along</span><span class="p">(</span><span class="n">walk_out_money</span><span class="p">)){</span><span class="w">
  </span><span class="n">walk_out_money</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">one_series</span><span class="p">(</span><span class="n">B</span><span class="o">=</span><span class="m">200</span><span class="p">,</span><span class="w"> </span><span class="n">W</span><span class="p">,</span><span class="w"> </span><span class="n">L</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1000</span><span class="p">,</span><span class="w"> </span><span class="n">M</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">100</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">get_last</span><span class="w">
</span><span class="p">}</span><span class="w">
</span><span class="n">earning_series</span><span class="p">[</span><span class="n">W</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">mean</span><span class="p">(</span><span class="n">walk_out_money</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">200</span><span class="p">)</span><span class="w">
</span><span class="p">}</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">earning_series</span><span class="p">,</span><span class="n">xlab</span><span class="o">=</span><span class="s2">"successfully stoping number"</span><span class="p">,</span><span class="n">ylab</span><span class="o">=</span><span class="s2">"mean earning"</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="o">=</span><span class="s2">"How successfully stoping influence earning?"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>
<p>Â </p>

<p>When L changes, what is the mean earning.</p>
<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">earning_series</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rep</span><span class="p">(</span><span class="kc">NA</span><span class="p">,</span><span class="m">100</span><span class="p">)</span><span class="w">
</span><span class="k">for</span><span class="p">(</span><span class="n">L</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">seq</span><span class="p">(</span><span class="m">10</span><span class="p">,</span><span class="m">1000</span><span class="p">,</span><span class="n">by</span><span class="o">=</span><span class="m">10</span><span class="p">)){</span><span class="w">
</span><span class="n">walk_out_money</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rep</span><span class="p">(</span><span class="kc">NA</span><span class="p">,</span><span class="w"> </span><span class="m">1000</span><span class="p">)</span><span class="w">
</span><span class="k">for</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nf">seq_along</span><span class="p">(</span><span class="n">walk_out_money</span><span class="p">)){</span><span class="w">
  </span><span class="n">walk_out_money</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">one_series</span><span class="p">(</span><span class="n">B</span><span class="o">=</span><span class="m">200</span><span class="p">,</span><span class="w"> </span><span class="n">W</span><span class="o">=</span><span class="m">300</span><span class="p">,</span><span class="w"> </span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">M</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">100</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">get_last</span><span class="w">
</span><span class="p">}</span><span class="w">
</span><span class="n">earning_series</span><span class="p">[</span><span class="n">L</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">mean</span><span class="p">(</span><span class="n">walk_out_money</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">200</span><span class="p">)</span><span class="w">
</span><span class="p">}</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">earning_series</span><span class="p">,</span><span class="n">xlab</span><span class="o">=</span><span class="s2">"maximum number of plays"</span><span class="p">,</span><span class="n">ylab</span><span class="o">=</span><span class="s2">"mean earning"</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="o">=</span><span class="s2">"How maximum number of plays influence earning?"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>
<p>Â </p>

<p>When M changes, what is the mean earning.</p>
<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">earning_series</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rep</span><span class="p">(</span><span class="kc">NA</span><span class="p">,</span><span class="m">100</span><span class="p">)</span><span class="w">
</span><span class="k">for</span><span class="p">(</span><span class="n">M</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">seq</span><span class="p">(</span><span class="m">10</span><span class="p">,</span><span class="m">1000</span><span class="p">,</span><span class="n">by</span><span class="o">=</span><span class="m">10</span><span class="p">)){</span><span class="w">
</span><span class="n">walk_out_money</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rep</span><span class="p">(</span><span class="kc">NA</span><span class="p">,</span><span class="w"> </span><span class="m">1000</span><span class="p">)</span><span class="w">
</span><span class="k">for</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nf">seq_along</span><span class="p">(</span><span class="n">walk_out_money</span><span class="p">)){</span><span class="w">
  </span><span class="n">walk_out_money</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">one_series</span><span class="p">(</span><span class="n">B</span><span class="o">=</span><span class="m">200</span><span class="p">,</span><span class="w"> </span><span class="n">W</span><span class="o">=</span><span class="m">300</span><span class="p">,</span><span class="w"> </span><span class="n">L</span><span class="o">=</span><span class="m">500</span><span class="p">,</span><span class="w"> </span><span class="n">M</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">get_last</span><span class="w">
</span><span class="p">}</span><span class="w">
</span><span class="n">earning_series</span><span class="p">[</span><span class="n">M</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">mean</span><span class="p">(</span><span class="n">walk_out_money</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">200</span><span class="p">)</span><span class="w">
</span><span class="p">}</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">earning_series</span><span class="p">,</span><span class="n">xlab</span><span class="o">=</span><span class="s2">"casino wager limit"</span><span class="p">,</span><span class="n">ylab</span><span class="o">=</span><span class="s2">"mean earning"</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="o">=</span><span class="s2">"How casino wager limit influence earning?"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>
<p>Â </p>

<p>Next, we can save the times that the game played before walk out then find out the characteristics.</p>
<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">get_times</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="nf">length</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w">
</span><span class="n">walk_out_times</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rep</span><span class="p">(</span><span class="kc">NA</span><span class="p">,</span><span class="w"> </span><span class="m">10000</span><span class="p">)</span><span class="w">
</span><span class="k">for</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nf">seq_along</span><span class="p">(</span><span class="n">walk_out_times</span><span class="p">)){</span><span class="w">
  </span><span class="n">walk_out_times</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">one_series</span><span class="p">(</span><span class="n">B</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">200</span><span class="p">,</span><span class="w"> </span><span class="n">W</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">300</span><span class="p">,</span><span class="w"> </span><span class="n">L</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1000</span><span class="p">,</span><span class="w"> </span><span class="n">M</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">100</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">get_times</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="n">hist</span><span class="p">(</span><span class="n">walk_out_times</span><span class="p">,</span><span class="w"> </span><span class="n">breaks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">100</span><span class="p">)</span><span class="w">

</span><span class="n">mean</span><span class="p">(</span><span class="n">walk_out_times</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>
<p>Â </p>

<p>The limitation of simulation is obvious. It is a black box actually. We can not use it as we proof it by mathematical method. We donâ€™t know why it happened and how it happened, so we can only change the parameter to try to understand the process. By the way, it is not a precise result. Everytime we get a answer, it will change a little bit next time.</p>
:ET